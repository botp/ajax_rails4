{"name":"Ajax rails4","tagline":"Example of Ajax in Rails4","body":"# Rails version 4 - Simple Ajax with Javascript\r\n\r\nClone this project to test Ajax in Rails 4. This method should also work for Rails 3, minus the use of strong parameters.\r\n\r\nFollow the regular rails project creation process.\r\n\r\n**Step#1**\r\n\r\nDisable CoffeeScript (for regular javascript users) before creating your controller in Rails Gemfile by commenting it out as follows:\r\n\r\n\t\t#Use CoffeeScript for .js.coffee assets and views\r\n\t\t#gem 'coffee-rails', '~> 4.0.0'\r\n\r\n\r\n**Step#2**\r\n\r\nCreate your controllers\r\n\r\nThe app/assets/javascripts will now generate [ControllerName].js files instead of [ControllerName].js.coffee\r\n\r\n\r\n**Step#3**\r\n\r\nAdd the following to the [ControllerName].js file:\r\n\r\n\t\tvar ready = function() {\r\n\t\t\t// your javascript code here\r\n\t\t};\r\n\t\t$(document).ready(ready);\r\n\t\t$(document).on('page:load', ready); // this will allows link_to helpers to work correctly\r\n\r\n\r\n**Step#4**\r\n\r\nProceed to create your forms (refer to example in the **app/views/products/new.html.erb** of this project for both regular html and simple_form).\r\n\r\n  **Regular HTML form**\r\n\r\n\t\t<form id=\"new_product\" action=\"/products\" method=\"post\">\r\n\t\t\t<input name=\"authenticity_token\" value=\"<%= form_authenticity_token %>\" type=\"hidden\">\r\n\t\t\t<label for=\"product[name]\">Name</label>\r\n\t\t\t<input type=\"text\" name=\"product[name]\">\r\n\t\t\t<label for=\"product[description]\">Description</label>\r\n\t\t\t<textarea type=\"text\" name=\"product[description]\" ></textarea>\r\n\t\t\t<label for=\"product[price]\">Price</label>\r\n\t\t\t<input type=\"text\" name=\"product[price]\">\r\n\t\t\t<input type=\"submit\" value=\"generate product\">\r\n\t\t</form>\r\n\r\n  **Simple Form**\r\n\r\n\t\t<%= simple_form_for Product.new, html: {:id => \"new_product_simple_form\"} do |f| %>\r\n\t\t\t<%= f.input :name %>\r\n\t\t\t<%= f.input :description %>\r\n\t\t\t<%= f.input :price %>\r\n\t\t\t<%= f.submit :button, :value=>\"generate product\" %>\r\n\t\t<% end %>\r\n\r\n\r\n**Step#5**\r\n\r\nAdd the ajax to listen for form submission (refer to example in the **app/assets/javascripts/products.js** file in this project)\r\n\r\n  **Regular HTML form javascript**\r\n\r\n\t\t// regular html form example\r\n\t\t$('#new_product').submit(function() {\r\n\t\t\tconsole.log(\"form submit hit\"); // for debug\r\n\t\t\t$.post(\r\n\t\t\t\t$(this).attr('action'),\r\n\t\t\t\t$(this).serialize(),\r\n\t\t\t\tfunction(data) {\r\n\t\t\t\t\tconsole.log(data); // output response from backend; for debug\r\n\t\t\t\t\t$('#product_result').html(data.msg) // update product_result html contents\r\n\t\t\t\t},\r\n\t\t\t\t\"json\"\r\n\t\t\t)\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\r\n  **Simple Form javascript**\r\n\r\n\t\t// simple_form example\r\n\t\t$('#new_product_simple_form').submit(function() {\r\n\t\t\tconsole.log(\"form submit hit\"); // for debug\r\n\t\t\t$.post(\r\n\t\t\t\t$(this).attr('action'),\r\n\t\t\t\t$(this).serialize(),\r\n\t\t\t\tfunction(data) {\r\n\t\t\t\t\tconsole.log(data); // output response from backend; for debug\r\n\t\t\t\t\t$('#product_result').html(data.msg) // update product_result html contents\r\n\t\t\t\t},\r\n\t\t\t\t\"json\"\r\n\t\t\t)\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\r\nNote: Both regular html form and simple form use the same ajax method, two different IDs were used to illustrate the different forms in view.\r\n\r\n\r\n**Step#6**\r\n\r\nCreate controller backend to respond to ajax submission and to issue response. For this part refer to **app/controllers/products_controller.rb** in this project.\r\n\r\n    product = Product.new(product_params)\r\n    respond_to do |format|\r\n      if product.save\r\n        format.json {\r\n          render :json => {:error => \"none\", :msg => \"<p>Product Successfully Added!</p>\"}\r\n        }\r\n      else\r\n        format.json {\r\n          render :json => {:error => \"yes\", :msg => \"<p>Invalid Product!</p>\"}\r\n        }\r\n      end\r\n    end\r\n\t\t\r\n\r\nYour ajax should now work.\r\nEnjoy!\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}